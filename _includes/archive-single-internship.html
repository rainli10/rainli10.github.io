{% include base_path %}

{% if post.id %}
  {% assign title = post.title | markdownify | remove: "<p>" | remove: "</p>" %}
{% else %}
  {% assign title = post.title %}
{% endif %}

<div class="experience-item">
  <div class="experience-item__line" aria-hidden="true">
    <span class="experience-item__dot"></span>
  </div>

  <div class="experience-item__card">
    <div class="experience-item__meta">
      {% if post.duration %}
        <div class="experience-item__duration">{{ post.duration }}</div>
      {% elsif post.date %}
        <div class="experience-item__duration">{{ post.date | date: '%b %Y' }}</div>
      {% endif %}
      {% if post.location %}
        <div class="experience-item__location">{{ post.location }}</div>
      {% endif %}
    </div>

    <article class="experience-item__body" itemscope itemtype="http://schema.org/CreativeWork">
      <h2 class="experience-item__title" itemprop="headline">
        {% if post.link %}
          <a href="{{ post.link }}">{{ title }}</a>
        {% else %}
          <a href="{{ base_path }}{{ post.url }}" rel="permalink">{{ title }}</a>
        {% endif %}
      </h2>

      {% if post.company %}
        <div class="experience-item__company">
          {% if post.company_logo %}
            <img class="experience-item__logo" src="{{ post.company_logo | prepend: base_path }}" alt="{{ post.company }} logo">
          {% endif %}
          {% if post.company_url %}
            <a href="{{ post.company_url }}">{{ post.company }}</a>
          {% else %}
            {{ post.company }}
          {% endif %}
        </div>
      {% endif %}

      {% if post.summary %}
        <p class="experience-item__summary">
          {{ post.summary | markdownify | remove: "<p>" | remove: "</p>" }}
        </p>
      {% elsif post.excerpt %}
        <p class="experience-item__summary">
          {{ post.excerpt | markdownify | remove: "<p>" | remove: "</p>" }}
        </p>
      {% endif %}

      {% if post.highlights %}
        <ul class="experience-item__highlights">
          {% for item in post.highlights %}
            <li>{{ item }}</li>
          {% endfor %}
        </ul>
      {% endif %}

      {% if post.skills %}
        <div class="experience-item__skills">
          {% for skill in post.skills %}
            <span class="experience-item__tag">{{ skill }}</span>
          {% endfor %}
        </div>
      {% endif %}
    </article>
  </div>
</div>
